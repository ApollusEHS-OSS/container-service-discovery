= Service Discovery in Container Orchestration Frameworks on AWS

This repo has a simple example that shows service discovery for different container orchestration frameworks.

The sample application uses three services:

image::images/services.png[]

. `webapp`: Web application queries `greeter` and `name` service to generate a greeting for a person.
. `greeter`: A service returns a greeting based upon `greet` name/value keypair in the URL.
. `name`: A service that returns person's name based upon `id` name/value keypair in the URL.

All services are built as Node.js application. `services/webapp/package.json` takes four parameters:

. greeter service host
. greeter service port
. name service host
. name service port

`greeter` and `name` services should be deployed as-is.

== Build services

This is an optional step as images are already available in Docker Hub.

```
docker-compose build
```

== Run services

=== Using Docker

Make sure `services/webapp/package.json` is starting the service as:

```
"start": "node server.js greeter 8080 name 8080"
```

You may have to re-build the images.

Then start the services:

```
docker swarm init
docker stack up --compose-file=docker-compose.yml webapp
```

== Access service using web application

Access the following URLs:

```
http://localhost:8080
http://localhost:8080?greet=ho
http://localhost:8080?id=1
http://localhost:8080?greet=ho&id=1
```

== Delete services

=== Using Docker

```
docker stack rm webapp
docker swarm leave -f
```

