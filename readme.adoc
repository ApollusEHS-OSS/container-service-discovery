= Service Discovery in Container Orchestration Frameworks on AWS

This repo has a simple example that shows service discovery for different container orchestration frameworks.

The sample application uses three services:

image::images/services.png[]

. `webapp`: Web application queries `greeter` and `name` service to generate a greeting for a person.
. `greeter`: A service returns a greeting based upon `greet` name/value keypair in the URL.
. `name`: A service that returns person's name based upon `id` name/value keypair in the URL.

All services are built as Node.js application. `webapp` service need to be configured using four parameters:

. `GREETER_SERVICE_HOST`
. `GREETER_SERCICE_PORT`
. `GREETER_SERCICE_PATH`
. `NAME_SERVICE_HOST`
. `NAME_SERVICE_PORT`
. `NAME_SERVICE_PATH`

== Build services

Build the Docker images for different services:

```
docker-compose build
```

== Run services

=== Using Docker

The four parameter values are defined in `docker-compose.yml`.

Start the services:

```
docker swarm init
docker stack up --compose-file=docker-compose.yml webapp
```

== Access service using web application

Access the following URLs using curl or in browser:

```
http://localhost:8080
http://localhost:8080?greet=ho
http://localhost:8080?id=1
http://localhost:8080?greet=ho&id=1
```

== Delete services

=== Using Docker

```
docker stack rm webapp
docker swarm leave -f
```

